<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>go模块备忘录</title><meta name="twitter:title" content="{selectedLangDict[&#x27;title&#x27;]} • Encore"/><meta name="twitter:description" content="The most common Go modules concepts to remember."/><meta name="description" content="The most common Go modules concepts to remember."/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&amp;family=Work+Sans:wght@700&amp;display=swap"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/aec775588e67e63062aa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aec775588e67e63062aa.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-243337fbfd8c564bbe07.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-ce69a9164bd0c53d3724.js" as="script"/><link rel="preload" href="/_next/static/chunks/178-389e063ffc30a403b882.js" as="script"/><link rel="preload" href="/_next/static/chunks/778-d56e99e52c05b71f4b15.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-11208b8db8c75982fee2.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-37933689fa041d925458.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/go.mod-a1e2ddc6e1b81c3ded08.js" as="script"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&family=Work+Sans:wght@700&display=swap"/></head><body><div id="__next"><style>
      header {
        background-image: linear-gradient(to top right, #1BAAD1, #01A79C);
      }
      h1, h2, h3 { font-family: &#x27;Work Sans&#x27;, sans-serif; }
      h2, h3 { color: #00ACD7; }
      code { font-weight: bold; }
      .hl { color: #CF3063; }
    </style><div class="min-h-screen w-full bg-gray-200 flex justify-center items-center sm:p-4"><div class="w-full bg-white sm:rounded-lg max-w-screen-lg"><header class="lg:h-28 sm:rounded-t-lg text-white relative p-2"><div><div class="absolute top-0 right-0 flex items-center bottom-0 right-2 "><label class="sr-only">Language</label><select id="language" name="currency" class="focus:ring-indigo-200 v-full border-transparent bg-transparent text-gray-200 sm:text-sm rounded-md"><option value="en">English</option><option selected="" value="zh">Chinese</option></select></div></div><div class="flex items-center justify-center gap-4"><svg class="h-8 lg:h-20 w-auto" fill="currentColor" viewBox="0 0 205.32 76.66"><path d="M15.41,23.1c-.37,0-.48-.24-.26-.53l2.09-2.66a1.58,1.58,0,0,1,1.09-.53l35.74,0c.37,0,.5.26.3.57l-1.66,2.59a1.4,1.4,0,0,1-1,.57Z"></path><path d="M.37,32.3c-.37,0-.48-.24-.25-.53L2.21,29.1a1.54,1.54,0,0,1,1.08-.53l45.64,0a.46.46,0,0,1,.46.64l-.81,2.45a1,1,0,0,1-.88.63Z"></path><path d="M24.6,41.47c-.37,0-.52-.26-.34-.58l1.42-2.55a1.28,1.28,0,0,1,1-.59l20,0a.6.6,0,0,1,.61.67l-.23,2.39a.75.75,0,0,1-.73.67Z"></path><path d="M128.38,21.33c-6.28,1.56-10.59,2.85-16.77,4.4-1.53.38-1.64.53-2.93-1A13.07,13.07,0,0,0,104,21c-6.3-3.1-12.41-2.24-18,1.46a21.4,21.4,0,0,0-10.23,19A15.71,15.71,0,0,0,89.22,57.2c6.76.94,12.48-1.49,17-6.57,1-1.06,1.72-2.28,2.74-3.66H89.71c-2.09,0-2.57-1.28-1.86-3,1.26-3.06,3.7-8.34,5.1-10.92a2.74,2.74,0,0,1,2.45-1.64h36.42c-.17,2.71-.17,5.44-.56,8.1a42.47,42.47,0,0,1-8.21,19.65c-7.17,9.5-16.56,15.41-28.46,17-9.78,1.28-18.88-.63-26.85-6.65A31.5,31.5,0,0,1,55,47.3C53.71,36.37,56.89,26.64,63.49,18A44.25,44.25,0,0,1,91.5.73C100.88-1,109.86.17,118,5.59a31.67,31.67,0,0,1,11.58,14.14C129.92,20.56,129.51,21.06,128.38,21.33Z"></path><path d="M161.42,76.66c-9.15-.17-17.41-2.8-24.36-8.8a31.34,31.34,0,0,1-10.8-19.31c-1.79-11.28,1.33-21.29,8.15-30.21,7.31-9.58,16.12-14.61,28-16.73,10.18-1.82,19.8-.77,28.47,5.15,7.92,5.41,12.84,12.69,14.08,22.27,1.74,13.45-2.21,24.48-11.51,33.92a45.26,45.26,0,0,1-24,12.78C166.79,76.25,164.09,76.36,161.42,76.66Zm23.86-40.43c-.11-1.3-.11-2.33-.29-3.32-1.78-9.89-10.88-15.46-20.41-13.33-9.35,2.08-15.31,8-17.48,17.38a16.47,16.47,0,0,0,9.17,18.88,18.28,18.28,0,0,0,16.32-.61C180.45,51.25,184.76,44.83,185.28,36.23Z"></path></svg><h1 class="text-xl lg:text-5l">go模块备忘录</h1></div><footer class="text-right lg:absolute bottom-2 right-2 print:right-8 text-xs">by <a href="https://twitter.com/_eandre" target="_blank" rel="nofollow" class="hover:underline">@_eandre</a></footer></header><div class="p-2 lg:p-8 text-sm lg:text-base max-w-screen-lg overflow-auto"><section><h2 class="text-xl lg:text-4xl mb-6">快速入门</h2><pre class="font-mono leading-none"><div class="text-gray-400"># 依赖管理</div><div class="text-gray-400 block sm:hidden mt-3"># 添加或更新依赖</div>go get -d github.com/path/to/module       <span class="text-gray-400 hidden sm:inline"># 添加或更新依赖</span><br/><div class="text-gray-400 block sm:hidden"># 特殊版本</div>go get -d github.com/dep/two/v2<span class="hl">@v2.1.0</span>    <span class="text-gray-400 hidden sm:inline"># 特殊版本</span><br/><div class="text-gray-400 block sm:hidden"># 用特殊分支</div>go get -d github.com/dep/commit<span class="hl">@branch</span>    <span class="text-gray-400 hidden sm:inline"># 用特殊分支</span><br/><div class="text-gray-400 block sm:hidden"># 在子目录中更新所有模块</div>go get -d -u ./...                        <span class="text-gray-400 hidden sm:inline"># 在子目录中更新所有模块</span><br/><br/><div class="text-gray-400 block sm:hidden"># 移除依赖</div>go get -d github.com/dep/legacy<span class="hl">@none</span>      <span class="text-gray-400 hidden sm:inline"># 移除依赖</span><br/><br/><div class="text-gray-400 mt-3 sm:mt-0"># 常用命令</div><div class="text-gray-400 block sm:hidden mt-3"># 在 go.mod 和 go.sum 中 添加新模块且移除不用的模块</div>go mod tidy                               <span class="text-gray-400 hidden sm:inline"># 在 go.mod 和 go.sum 中 添加新模块且移除不用的模块</span><br/><div class="text-gray-400 block sm:hidden mt-3"># 下载模块并缓存</div>go mod download                           <span class="text-gray-400 hidden sm:inline"># 下载模块并缓存</span><br/><div class="text-gray-400 block sm:hidden mt-3"># 初始化新模块</div>go mod init github.com/path/to/module     <span class="text-gray-400 hidden sm:inline"># 初始化新模块</span><br/><div class="text-gray-400 block sm:hidden mt-3"># 为什么依赖?</div>go mod why -m github.com/path/to/module   <span class="text-gray-400 hidden sm:inline"># 为什么依赖?</span><br/><div class="text-gray-400 block sm:hidden mt-3"># 构建和安装二进制模块</div>go install github.com/path/to/bin<span class="hl">@latest</span>  <span class="text-gray-400 hidden sm:inline"># 构建和安装二进制模块</span></pre></section><section class="mt-6 lg:mt-10"><h2 class="text-xl lg:text-4xl mb-6">解析go.mod</h2><svg class="w-full h-auto" viewBox="0 0 781.04 387.45"><defs><style>
          .cls-1 {
            fill: #cf3063;
          }

          .cls-2 {
            fill: #24a091;
          }

          .cls-3, .cls-5 {
            fill: none;
            stroke-miterlimit: 10;
          }

          .cls-3 {
            stroke: #D1D5DB;
            stroke-width: 1.3px;
          }

          .cls-4 {
            fill: #D1D5DB;
          }

          .cls-5 {
            stroke: #000;
            stroke-width: 3px;
          }

          .code {
            font-size: 17px;
            letter-spacing: 0.029em;
            font-family: &#x27;Source Code Pro&#x27;, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;
            white-space: pre;
          }

          .note {
            font-size: 12px;
            font-family: &#x27;Inter var&#x27;, sans-serif;
            font-weight: 300;
            fill: #24A091;
          }
          .hl { fill: #CF3063; }
        </style></defs><g transform="translate(18.4 24.5)"><text x="0" y="0" class="code"><tspan x="0" dy="0">module github.com/my/library</tspan><tspan x="0" dy="2.5em">go 1.16</tspan><tspan x="0" dy="2.5em">require (</tspan><tspan x="0" dy="1.25em">    github.com/dep/one    v1.0.0</tspan><tspan x="0" dy="1.25em">    github.com/dep/two<tspan class="hl">/v2</tspan> v2.3.0</tspan><tspan x="0" dy="2.5em">    github.com/dep/other <tspan class="hl">v0.0.0-20180523231146-b3f5c0f6e5f1</tspan></tspan><tspan x="0" dy="1.25em">    github.com/dep/legacy <tspan class="hl">v2.0.0+incompatible</tspan></tspan><tspan x="0" dy="1.25em">)</tspan><tspan x="0" dy="2.5em">exclude github.com/dep/legacy v1.9.2</tspan><tspan x="0" dy="2.5em">replace github.com/dep/one <!-- -->=&gt;<!-- --> github.com/fork/one</tspan></text></g><g transform="translate(420.9 9)"><text x="0" y="0" class="note">本机模块名称</text></g><g transform="translate(420.9 44.5)"><text x="0" y="0" class="note"><tspan x="0" dy="0">Go 版本</tspan><tspan x="0" dy="1.25em"></tspan></text></g><g transform="translate(420.9 92.5)"><text x="0" y="0" class="note">v2和以后的版本将被使用</text></g><g transform="translate(560.9 135)"><text x="0" y="0" class="note"><tspan x="0" dy="0">模糊版本依赖不是tag版本就用最近提交</tspan><tspan x="0" dy="1.25em"></tspan></text></g><g transform="translate(553 247)"><text x="0" y="0" class="note"><tspan x="0" dy="0">不兼容包意思是没有合并到模块中</tspan><tspan x="0" dy="1.25em"></tspan></text></g><g transform="translate(211 363.5)"><text x="0" y="0" class="note">替换模块</text></g><g transform="translate(15 355)"><text x="0" y="0" class="note"><tspan x="0" dy="0">排除特殊的版本号</tspan><tspan x="0" dy="1.25em"></tspan><tspan x="0" dy="1.25em"></tspan></text></g><g><path class="cls-3" d="M555.11,139.9c-9.77-1.25-33.79-3-59.24,10a99.8,99.8,0,0,0-29.63,23.15" transform="translate(-1.35 -1.23)"></path><polygon class="cls-4" points="464.34 168.94 465.48 171.3 467.96 172.12 462.38 174.82 464.34 168.94"></polygon></g><g><path class="cls-3" d="M551.1,258.39a169.55,169.55,0,0,1-49.21-3,171.77,171.77,0,0,1-66.19-29.8" transform="translate(-1.35 -1.23)"></path><polygon class="cls-4" points="437.27 223.48 435.02 224.8 434.41 227.34 431.25 222.01 437.27 223.48"></polygon></g><g><path class="cls-3" d="M13.5,352.5c-2.42-4.36-15.4-19.05-9.67-40.89a57.72,57.72,0,0,1,11.49-22.2" transform="translate(-1.73 -1.23)"></path><polygon class="cls-4" points="14.24 291.17 13.09 288.82 10.6 288.02 16.15 285.28 14.24 291.17"></polygon></g><g><path class="cls-3" d="M417.54,89.69c-10.2-2.18-76.33-15.33-117.48,25.11a91.74,91.74,0,0,0-15.2,19.7" transform="translate(-1.35 -1.23)"></path><polygon class="cls-4" points="282.42 130.52 283.99 132.61 286.58 132.94 281.63 136.66 282.42 130.52"></polygon></g><g><path class="cls-3" d="M416.54,48.52c-69.36-2-143.54-1.14-221.92,4q-46,3-89.53,7.63" transform="translate(-1.35 -1.23)"></path><polygon class="cls-4" points="105.33 56.4 104.54 58.89 105.79 61.19 99.88 59.34 105.33 56.4"></polygon></g><g><path class="cls-3" d="M418.55,6.35a146.42,146.42,0,0,0-94.89,8.42" transform="translate(-1.35 -1.23)"></path><polygon class="cls-4" points="323.07 10.68 323.09 13.3 324.98 15.1 318.79 15.16 323.07 10.68"></polygon></g><path class="cls-5" d="M750.92,221.24" transform="translate(-1.35 -1.23)"></path><path class="cls-5" d="M536,285.5" transform="translate(-1.35 -1.23)"></path><g><line class="cls-3" x1="263.43" y1="352.56" x2="254.26" y2="335.87"></line><polygon class="cls-4" points="257.25 336.31 254.64 336.58 253.03 338.63 252.39 332.47 257.25 336.31"></polygon></g><g><line class="cls-3" x1="366.86" y1="352.56" x2="376.04" y2="335.87"></line><polygon class="cls-4" points="377.27 338.63 375.65 336.58 373.05 336.31 377.91 332.47 377.27 338.63"></polygon></g><path class="cls-5" d="M138.39,405" transform="translate(-1.35 -1.23)"></path></svg></section><section class="mt-6 lg:mt-10"><h2 class="text-xl lg:text-4xl mb-6">最小化版本选择 (MVS)</h2><div class="flex flex-col gap-y-4"><p>要构建一个程序，Go需要确切地知道您需要哪些依赖项，以及使用哪个版本。</p><p>Go使用MVS作为一种可预测且简单的方法来决定使用哪个版本。</p><p>它的工作如下:</p><ol class="list-inside list-decimal pl-4"><li>选中运行的模块（主模块）</li><li>查找主模块需要的所有依赖项（递归地，使用依赖项的go.mod文件）</li><li>对于每个依赖项，使用<code>go.mod</code>显式指定的最大版本</li></ol></div><h3 class="text-2xl mt-6 mb-4">例子</h3><div class="flex flex-col lg:flex-row gap-4 text-sm"><div><img src="/mvs.svg" class="mx-auto h-32 lg:h-48 w-auto"/></div><div class="flex flex-col gap-y-4"><p>在例子中, 主版本依赖 <code>A 1.0</code> 和 <code>B 2.1</code>。</p><p><code>B 2.1</code> 依赖 <code>A 1.1</code>, 使用 <code>A</code> 版本。</p><p><code>A 1.1</code> 被使用, 它拉取 <code>C 1.1</code> 版本。</p><p>最终依赖如下:<ul class="list-inside list-disc"><li><code>A 1.1</code></li><li><code>B 2.1</code></li><li><code>C 1.1</code></li></ul></p></div></div></section></div><div class="text-center py-2 text-xs"><div>© 2021 André Eriksson — <a class="text-indigo-600 hover:text-indigo-400" href="https://encore.dev" target="_blank">encore.dev</a></div><div>贡献在 <a class="text-indigo-600 hover:text-indigo-400" href="https://github.com/encoredev/cheatsheets" rel="nofollow" target="_blank">https://github.com/encoredev/cheatsheets</a> (MIT License)</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/go.mod","query":{},"buildId":"hzzaAp6RCoV5a7Y_KPSjJ","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-243337fbfd8c564bbe07.js" async=""></script><script src="/_next/static/chunks/framework-ce69a9164bd0c53d3724.js" async=""></script><script src="/_next/static/chunks/178-389e063ffc30a403b882.js" async=""></script><script src="/_next/static/chunks/778-d56e99e52c05b71f4b15.js" async=""></script><script src="/_next/static/chunks/main-11208b8db8c75982fee2.js" async=""></script><script src="/_next/static/chunks/pages/_app-37933689fa041d925458.js" async=""></script><script src="/_next/static/chunks/pages/go.mod-a1e2ddc6e1b81c3ded08.js" async=""></script><script src="/_next/static/hzzaAp6RCoV5a7Y_KPSjJ/_buildManifest.js" async=""></script><script src="/_next/static/hzzaAp6RCoV5a7Y_KPSjJ/_ssgManifest.js" async=""></script></body></html>